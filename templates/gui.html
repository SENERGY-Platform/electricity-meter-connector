<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<title>Ferraris Arduino Serial Gateway</title>
	<meta name="keywords" content="" />
	<meta name="description" content="" />
	<link rel=stylesheet type=text/css href="{{ url_for('static', filename='style.css')|autoversion }}">
	<script src="{{ url_for('static', filename='gui.js')|autoversion }}"></script>
</head>

<body>

<div id="modal" class="modal">

  <!-- Modal content -->
	<div class="modal-content">
		<form id="configuration" action="javascript:" onsubmit="submitConf('{{ d_id }}');">
			<label for="nat">Average Threshold: </label><input id="nat" type="number" min="0" max="100000" required><br><br>
			<label for="dt">Detection Threshold: </label><input id="dt" type="number" min="0" max="100000" required><br><br>
			<label for="lld">Delta: </label><input id="lld" type="number" min="0" max="100000" required><br><br>
			<label for="rpkwh">Rotations / kWh: </label><input id="rpkwh" type="number" min="0" max="100000" required><br><br>
			<label for="tkwh">Total kWh: </label><input id="tkwh" type="text" required><br><br>
			<input type="submit" value="Save"><button class="btn" type="button" onclick="toggleConfModal();">Cancel</button>
		</form>
	</div>

</div>

<div class="wrapper">

	<div class="header">
		{% if d_id %}
		{{ d_id }}
		{% else %}
		Ferraris Arduino Serial Gateway
		{% endif %}
    </div><!-- .header-->

	<div class="main-navigation">
		{% for device in devices %}
		{% if device == d_id %}
		<button class="btnactive" type="button" onclick="location.href=('{{ device }}');">Device {{ device }}</button>
		{% else %}
		<button class="btn" type="button" onclick="location.href=('{{ device }}');">Device {{ device }}</button>
		{% endif %}
		{% endfor %}
	</div>

	{% if d_id %}
	<div id="content" class="content">
		<img id="logo" src="{{ url_for('static', filename='logo.svg') }}">
		<div id="console"></div>
	</div>

	<div class="sub-navigation">
		<button class="btn" type="button" id="rs_btn">Read Sensor</button>
		<button class="btn" type="button" id="dbg_btn">Debug Mode</button>
		<button class="btn" type="button" id="strt_btn">Start Detection</button>
		<button class="btn" type="button" id="stp_btn">Stop Current Action</button>
		<br><br>
		<button class="btn" type="button" onclick="toggleConfModal('{{ d_id }}/conf');">Configure</button>
		<button class="btn" type="button" id="res_btn">Reset</button>
		<label class="container">Autostart
			<input id="astrt" type="checkbox" onclick="toggleAstrt(this);">
			<span class="checkmark"></span>
		</label>
	</div>
	{% endif %}

</div><!-- .wrapper -->

<script>
	/*
	httpGetConf('{{ d_id }}/conf');
    var conf_modal = document.getElementById('conf_modal');
    var btn = document.getElementById("myBtn");
    var span = document.getElementsByClassName("close")[0];
    btn.onclick = function() {
        httpGetConf('{{ d_id }}/conf');
        conf_modal.style.display = "block";
    };
    span.onclick = function() {
        var nat = document.getElementById("nat");
        var dt = document.getElementById("dt");
        var lld = document.getElementById("lld");
        var rpkwh = document.getElementById("rpkwh");
        var tkwh = document.getElementById("tkwh");
        if (nat.checkValidity()) {
            if (dt.checkValidity()) {
                if (lld.checkValidity()) {
                    if (rpkwh.checkValidity()) {
                        if (tkwh.checkValidity()) {
                            httpPostConf('{{ d_id }}/conf', nat.value, dt.value, lld.value, rpkwh.value, tkwh.value);
							conf_modal.style.display = "none";
                        } else {
                            tkwh.value = '';
						}
					} else {
                        rpkwh.value = '';
					}
                } else {
                    lld.value = '';
				}
            } else {
                dt.value = '';
			}
        } else {
            nat.value = '';
		}
    };
    window.onclick = function(event) {
        if (event.target == conf_modal) {
            conf_modal.style.display = "none";
        }
    }*/
</script>

</body>
</html>